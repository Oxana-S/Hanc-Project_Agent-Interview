# Voice Interviewer Agent - Полное описание проекта

## Что создано

Система агента-интервьюера для сбора требований к голосовым ассистентам.

### Ключевые возможности

- **Maximum Interview Mode** — единый режим с тремя фазами (Discovery → Structured → Synthesis)
- **Активный анализ** — DeepSeek LLM анализирует каждый ответ
- **Уточняющие вопросы** — до 3 уточнений при неполных ответах
- **Два паттерна**: INTERACTION (клиенты) и MANAGEMENT (сотрудники)
- **Хранение контекста** — Redis (сессии) + PostgreSQL (анкеты)
- **Rich CLI** — визуализация прогресса в реальном времени

---

## Структура проекта

```
voice_interviewer/
│
├── src/                              # Исходный код
│   ├── __init__.py                   # Экспорты пакета
│   ├── models.py                     # Модели данных (Pydantic)
│   │
│   ├── interview/                    # Логика интервью
│   │   ├── __init__.py
│   │   ├── maximum.py                # MaximumInterviewer (главный класс)
│   │   ├── phases.py                 # InterviewPhase, FieldStatus, CollectedInfo
│   │   └── questions/                # Вопросы по паттернам
│   │       ├── __init__.py
│   │       ├── interaction.py        # 40 вопросов для клиентов
│   │       └── management.py         # 38 вопросов для сотрудников
│   │
│   ├── storage/                      # Хранение данных
│   │   ├── __init__.py
│   │   ├── redis.py                  # RedisStorageManager
│   │   └── postgres.py               # PostgreSQLStorageManager
│   │
│   ├── llm/                          # LLM клиенты
│   │   ├── __init__.py
│   │   ├── deepseek.py               # DeepSeekClient
│   │   └── anketa_generator.py       # Генерация полной анкеты
│   │
│   └── cli/                          # CLI интерфейсы
│       ├── __init__.py
│       ├── interface.py              # Базовый CLI
│       └── maximum.py                # CLI для Maximum режима
│
├── scripts/                          # Точки входа
│   ├── demo.py                       # Главный скрипт запуска
│   └── healthcheck.py                # Проверка системы
│
├── docs/                             # Документация
│   ├── QUICKSTART.md
│   ├── PROJECT_OVERVIEW.md           # Этот файл
│   ├── START_HERE.md
│   └── example_anketa.md
│
├── config/                           # Конфигурация
│   ├── docker-compose.yml
│   └── init_db.sql
│
├── tests/                            # Тесты (123 теста)
├── output/                           # Результаты интервью
│
├── .env.example
├── requirements.txt
└── README.md
```

---

## Maximum Interview Mode

### Три фазы

```
┌─────────────────────────────────────────────────────────┐
│                 MAXIMUM INTERVIEW MODE                   │
│                                                         │
│   DISCOVERY ──────► STRUCTURED ──────► SYNTHESIS        │
│       │                 │                  │            │
│       ▼                 ▼                  ▼            │
│   Свободный        Целенаправ-        Генерация        │
│   диалог           ленный сбор        анкеты           │
│   о бизнесе        данных             через LLM        │
└─────────────────────────────────────────────────────────┘
```

### Discovery Phase (Открытие)

- Консультативный диалог без жёсткой структуры
- Клиент рассказывает о бизнесе в свободной форме
- AI извлекает информацию из контекста
- Минимум 5, максимум 15 ходов (настраивается)

### Structured Phase (Структурированный сбор)

- Целенаправленные вопросы по недостающим полям
- Приоритизация: REQUIRED → IMPORTANT → OPTIONAL
- До 3 уточнений на вопрос
- Автоматический переход при заполнении 80%+ полей

### Synthesis Phase (Синтез)

- Генерация полной анкеты через DeepSeek
- Заполнение недостающих полей из контекста
- Экспорт в JSON и Markdown
- Сохранение в PostgreSQL

---

## Паттерны интервью

### INTERACTION (Клиенты компании)

Для агентов, работающих с внешними клиентами.

**Разделы анкеты:**

1. **Базовая информация** (5 вопросов)
   - Название компании
   - Отрасль
   - Язык агента
   - Основная задача агента

2. **Клиенты и услуги** (15 вопросов)
   - Тип бизнеса
   - Направление звонков
   - Услуги и продукты
   - Ценообразование
   - Типы клиентов

3. **Интеграции** (12 вопросов)
   - Email, календарь, SMS, WhatsApp
   - Переадресация звонков

4. **Дополнительно** (8 вопросов)
   - Примеры диалогов
   - Ограничения

**Итого: 40 вопросов**

### MANAGEMENT (Сотрудники компании)

Для внутренних агентов.

**Разделы анкеты:**

1. **Базовая информация** (4 вопроса)
2. **Структура и функции** (14 вопросов)
3. **Интеграции** (12 вопросов)
4. **Дополнительно** (8 вопросов)

**Итого: 38 вопросов**

---

## Анализ ответов через DeepSeek

Каждый ответ анализируется LLM:

```python
{
    "completeness_score": 0.75,        # Полнота (0-1)
    "needs_clarification": True,       # Нужно уточнение?
    "extracted_fields": {              # Извлечённые данные
        "company_name": "TechSolutions",
        "industry": "IT"
    },
    "clarification_questions": [       # Уточняющие вопросы
        "Какие конкретно услуги вы предлагаете?",
        "Каков ценовой диапазон?"
    ]
}
```

### Когда задаются уточнения

1. **Короткий ответ** (< 15 слов для важных вопросов)
2. **Нет конкретных примеров**
3. **Противоречия** с предыдущими ответами
4. **Неясные термины**
5. **Пропущены обязательные детали**

**Максимум уточнений:** 3 на вопрос

---

## Хранение данных

### Redis (Текущие сессии)

- **Назначение:** Быстрый доступ к активным интервью
- **TTL:** 2 часа (настраивается)
- **Ключ:** `interview:session:{session_id}`
- **Данные:** Полный контекст интервью

### PostgreSQL (Долгосрочное хранение)

**Таблица `anketas`:**

- Заполненные анкеты
- Полные ответы клиентов
- Метрики качества

**Таблица `interview_sessions`:**

- История всех интервью
- Статистика и метрики

---

## Технологии

- **Python 3.9+**
- **DeepSeek API** — анализ и генерация
- **Redis** — кэш сессий
- **PostgreSQL** — долгосрочное хранение
- **Pydantic** — валидация данных
- **Rich** — CLI интерфейс
- **structlog** — логирование
- **Docker** — контейнеризация

---

## Быстрый старт

```bash
# 1. Установка
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 2. Конфигурация
cp .env.example .env
# Заполните DEEPSEEK_API_KEY

# 3. Инфраструктура
docker-compose -f config/docker-compose.yml up -d

# 4. Запуск
python3 scripts/demo.py
```

---

## Метрики успеха

1. **Полнота анкеты:** 100% обязательных полей
2. **Качество ответов:** 80%+ с конкретными примерами
3. **Глубина уточнений:** 1-2 на важный блок
4. **Время интервью:** 15-30 минут

---

## Дальнейшее развитие

### Готово

- [x] Maximum Interview Mode (Discovery + Structured + Synthesis)
- [x] DeepSeek интеграция
- [x] Rich CLI интерфейс
- [x] Redis + PostgreSQL хранение
- [x] 123 юнит-теста

### Roadmap

- [ ] WebSocket API для web интерфейса
- [ ] Экспорт анкет в PDF/DOCX
- [ ] Multi-язычная поддержка
- [ ] Голосовой интерфейс (Azure OpenAI Realtime)

---

*Версия: 2.0.0*
*Дата: 2026-02-02*
